
<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
           <script src="https://telegram.org/js/telegram-web-app.js"></script>
<!--Semantic-UI + commit -->
<!--    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" rel="stylesheet" type="text/css" />-->
<!--    <link href="https://cdn.rawgit.com/mdehoog/Semantic-UI/6e6d051d47b598ebab05857545f242caf2b4b48c/dist/semantic.min.css" rel="stylesheet" type="text/css" />-->
<!--    <script src="https://code.jquery.com/jquery-2.1.4.js"></script>-->
<!--    <script src="semantic.min_.js"></script>-->

<!--fomantic-ui  -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/fomantic-ui@2.9.3/dist/semantic.min.css">
  <script src="https://cdn.jsdelivr.net/npm/fomantic-ui@2.9.3/dist/semantic.min.js"></script>

  <meta charset="UTF-8">
  <title>Gagarin data labs</title>
</head>
<body>


<!--
<div class="ui info message">
  MOEX - аналитика Московской биржи
</div>

<div class="ui styled fluid accordion">
  <div class="title active">
    <i class="dropdown icon"></i>
    MOEX - аналитика Московской биржи
  </div>
  <div class="content active">
    <p class="visible" style="display: block !important;">
      Поиск схожих по поведению акций за период
  </div>
  <div class="title">
    <i class="dropdown icon"></i>
    What kinds of dogs are there?

  </div>
  <div class="content">
    <p class="transition hidden">
      <input type="radio" name="moex" value="1.1"/>
      There are many breeds of dogs. Each breed varies in size and temperament. Owners often select a breed of dog that they find to be compatible with their own lifestyle and desires from a companion.</p>
  </div>
  <div class="title">
    <i class="dropdown icon"></i>
    How do you acquire a dog?
  </div>
  <div class="content">
    <p class="transition hidden">Three common ways for a prospective owner to acquire a dog is from pet shops, private owners, or shelters.</p>
    <p class="transition hidden">A pet shop may be the most convenient way to buy a dog. Buying a dog from a private owner allows you to assess the pedigree and upbringing of your dog before choosing to take it home. Lastly, finding your dog from a shelter, helps give a good home to a dog who may not find one so readily.</p>
  </div>
</div>
-->

<div class="ui styled accordion">
  <div class="title active">
    <i class="dropdown icon"></i>
    MOEX - аналитика Московской биржи
  </div>
  <div class="content active">
    Аналитика разная
    <div class="accordion visible" style="display: block !important;">
      <div class="active title">
          <i class="dropdown icon"></i>
          Поиск схожих по поведению акций за период
      </div>
      <div class="active content">
        <p>Период</p>
        <div class="accordion visible" style="display: block !important;">
          <div class="title">
              <i class="dropdown icon"></i>
              интервал дат / цена за разовый запрос
          </div>
          <div class="active content">
            <form>
             <table>
                <tr>
                     <td></td>
                     <td colspan="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="radio" name="moex" value="1.1">  до 2х недель /  бесплатно</td>
                     <td></td>
                     <td></td>
                 </tr>
                      <tr>
                     <td></td>
                     <td colspan="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="radio" name="moex" value="1.2" disabled>  до 1 месяца /  tbd руб.</td>
                     <td></td>
                     <td></td>
                 </tr>
                 <tr>
                     <td></td>
                     <td colspan="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="radio" name="moex" value="1.3" disabled>  до 3 месяцев /  tbd руб.</td>
                     <td></td>
                     <td></td>
                 </tr>
                 <tr>
                     <td></td>
                     <td colspan="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="radio" name="moex" value="1.4" disabled>  до 6 месяцев /  tbd руб.</td>
                     <td></td>
                     <td></td>
                 </tr>
                 <tr>
                     <td></td>
                     <td colspan="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="radio" name="moex" value="1.5" disabled>  до 1 года /  tbd руб.</td>
                     <td></td>
                     <td></td>
                 </tr>

             </table>

              <p/>

              <div class="ui form">
                <div class="two fields">
                  <table width="185px">
                    <tr>
                      <td>
                        <div class="field">
                          <!--<label>начало периода</label>-->
                          <div class="ui calendar" id="rangestart">
                            <div class="ui input left icon">
                              <i class="calendar icon"></i>
                              <input type="text" placeholder="начало периода">
                            </div>
                          </div>
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <td>
                      <div class="field">
                        <!--<label>окончание периода</label>-->
                        <div class="ui calendar" id="rangeend">
                          <div class="ui input left icon">
                            <i class="calendar icon"></i>
                            <input type="text" placeholder="окончание периода"> <!--value="10/29/2023 3pm">-->
                          </div>
                        </div>
                      </div>
                      </td>
                    </tr>
                  </table>
                  </div>
              </div>
                <br/>
                <!--<p style="margin-left: 100px;">-->
                    <input id="clickMe" type="button" value='Ok ✔' onclick="checkButton();" />
                    <h3 id="disp" style= "color:green"> </h3>
                    <h4 id="error" style= "color:red"> </h4>
                <!--</p>-->
            </form>

          </div>
<!--
          <div class="title">
              <i class="dropdown icon"></i>
              Level 1A-B
          </div>
          <div class="content">
              Level 1A-B Contents
          </div>
-->
        </div>
      </div>
      <!--
      <div class="title">
          <i class="dropdown icon"></i>
          Level 1B
      </div>
      <div class="content">
          Level 1B Contents
      </div>
      <div class="title">
          <i class="dropdown icon"></i>
          Level 1C
      </div>
      <div class="content">
          Level 1C Contents
      </div>
      -->
    </div>
  </div>
  <div class="title">
    <i class="dropdown icon"></i>
    Другие продукты (0)
  </div>
  <div class="content">
    <p>по мере появления мы будем добавлять новые продукты</p>
    <!--
    <div class="accordion">
      <div class="active title">
        <i class="dropdown icon"></i>
        Level 2A
      </div>
      <div class="active content">
        <p>Level 2A Contents</p>
        <div class="accordion">
          <div class="title">
              <i class="dropdown icon"></i>
              Level 2A-A
          </div>
          <div class="content">
              Level 2A-A Contents
          </div>
          <div class="title">
              <i class="dropdown icon"></i>
              Level 2A-B
          </div>
          <div class="content">
              Level 2A-B Contents
          </div>
        </div>
      </div>
      <div class="title">
          <i class="dropdown icon"></i>
          Level 2B
      </div>
      <div class="content">
          Level 2B Contents
      </div>
      <div class="title">
          <i class="dropdown icon"></i>
          Level 2C
      </div>
      <div class="content">
          Level 2C Contents
      </div>
    </div>
  </div>
  -->
</div>
</div>

</body>
<script>


const queryString = window.location.search;
const urlParams = new URLSearchParams(queryString);
dtm_tmp = new Date(urlParams.get('max_start_date'));
const max_start_date = new Date(dtm_tmp.getFullYear(), dtm_tmp.getMonth(), dtm_tmp.getDate());
dtm_tmp = new Date(urlParams.get('max_end_date'));
const max_end_date = new Date(dtm_tmp.getFullYear(), dtm_tmp.getMonth(), dtm_tmp.getDate());


  text_ru = {
    days: ["Вс", "Пн", "Вт", "Ср", "Чт", "Пт", "Сб"],
    months: ["Январь", "Февраль", "Март", "Апрель", "Май", "Июнь", "Июль", "Август", "Сентябрь", "Октябрь", "Ноябрь", "Декабрь"],
    monthsShort: ["Янв", "Фев", "Мар", "Апр", "Май", "Июн", "Июл", "Авг", "Сен", "Окт", "Ноя", "Дек"],
    today: "Сегодня",
    now: "Сейчас",
    am: "до полудня",
    pm: "после полудня"
  }

disabled_week_day = [0,6]

var today = new Date();
$('#rangestart').calendar({
  type: 'date',
  text: text_ru,
//  inline: true,
//  startMode: month,
disabledDaysOfWeek : disabled_week_day,
  firstDayOfWeek: 1,
  minDate: max_start_date,
  maxDate: max_end_date,
  endCalendar: $('#rangeend'),
  onChange: function (date, text) {
       var newValue = text;
       //alert(start_date);
       new_end_max_date = new Date(date.getFullYear(), date.getMonth(), date.getDate() +14)
       if (new_end_max_date > max_end_date) {
            new_end_max_date = max_end_date;
       }
       $('#rangeend').calendar('set maxDate', new_end_max_date);
       $('#rangeend').calendar('set minDate', new Date(date.getFullYear(), date.getMonth(), date.getDate() +5));
       $('#rangeend').calendar('clear');
  }
});


$('#rangeend').calendar({
  type: 'date',
  text: text_ru,
  firstDayOfWeek: 1,
  minDate: max_start_date,
  maxDate: max_end_date,
  startCalendar: $('#rangestart')
});


$('.ui.accordion')
  .accordion()
;

Telegram.WebApp.ready();
function checkButton() {

//      alert($('#rangeend').calendar('get startDate'))
//      $('.ui.accordion').accordion('open', 1)
//      $('.ui.accordion').accordion('toggle', 2)
//       alert(document.querySelector('input[name="moex"]:checked').value)

    selected_pk_item = document.querySelector('input[name="moex"]:checked');
    selected_start_date = $('#rangestart').calendar('get date');
    selected_end_date = $('#rangeend').calendar('get date');

    bln_input_valid = true;
    err_msg = ''
    if (selected_pk_item == null) {
        err_msg += "Вы не выбрали услугу.";
        bln_input_valid = false;
    }
    if (selected_start_date == null) {
        err_msg += "дату начала";
        bln_input_valid = false;
    }
    if (selected_end_date == null) {
        err_msg +=  "дату окончания";
        bln_input_valid = false;
    }
    //alert(bln_input_valid)
    if(bln_input_valid) {
            document.getElementById("disp").innerHTML
                = 'ок'


        const data = JSON.stringify({moex: selected_pk_item.value, sd: selected_start_date, ed: selected_end_date});
        Telegram.WebApp.sendData(data);
        Telegram.WebApp.close();

    }
    else {
        document.getElementById("error").innerHTML
            = "¯\_(ツ)_/¯ "+err_msg;
    }
}

</script>


</html>